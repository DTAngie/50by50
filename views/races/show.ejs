<%- include('../partials/header') %>
<%- include('../partials/nav') %>
<div class="container">
    <div class="left">
        <h2><%=race.name %></h2>
        <h4><%= race.city %> <%= race.state %></h4>
        <div id="fastest">
            <p id="fast-title">Fastest Time</p>
            <span><%= fastest.name %></span>
            <span><%= fastest.time %></span>
        </div>
        <div id="racers">
            <ul>
                <% runners.forEach(function(r){ %>
                    <li><a href="/users/profile/<%= r.runner.id %>"><%= r.runner.name %></a> <%= new Date(r.time * 1000).toISOString().substr(11,8) %></li>
                <% }) %>
            </ul>
        </div>
    </div>
    <div class="right">
        <h3>Post a Comment</h3>
        <div id="comment-form-container">
            <form id="new-comment-form" action="/races/<%= race._id %>/comments" method="POST">
                <label class="block" for="new-comment">Add New Comment</label>
                <textarea name="comment" id="new-comment"></textarea>
                <button class="centered" type="submit">Submit</button>
            </form>
        </div>

        <div class="all-comments">
            <% comments.forEach(function(c){ %>
                <div class="comment-container">
                    <div class="delete-item hidden" id="comment-<%= c._id %>-race-<%= race._id %>"></div>
                    <!-- TODO this needs to open a modal or pop up to confirm delete -->
                    <p class="comment-text">
                        <%= c.comment %>
                    </p>
                    <p class="commenter">
                        <%= c.user.name %> <span class="comment-date"><%= dateFormat(c.createdAt, "mmm d, yyyy") %></span>
                    </p>

                </div>
            <% }); %>
        </div>
    </div>
</div>

<%- include('../partials/footer') %>